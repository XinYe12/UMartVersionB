{%- assign collection = collections[section.settings.collectionproduct] -%}
<div class="sidebar-products side-box">
  <h3 class="box-heading">{{ section.settings.sidebar_product_title | escape }}</h3>
  <ul class="box-content">
    {% for product in collection.products %}
      <li class="product-side-item">
        <div class="product-block">
          <div class="left-block">
          <a class="shop-now" href="{{ product.url }}">
            <img src="{{ product.featured_image | product_img_url: '100x' }}" alt="{{ product.title | escape  }}" />
          </a>
          </div>
          <div class="right-block">
              <h4><a class="shop-now" href="{{ product.url }}">{{ product.title | escape }}</a></h4>
              <div class="price sideprice">{% render 'price', product: product, price_class: '' %}</div>
          </div>
        </div>  
      </li>  
    {% endfor %}
    {%- assign show_link_button = false -%}
    {%- if section.settings.button_label != blank and section.settings.button_link != blank -%}
      {%- assign show_link_button = true -%}
    {%- endif -%}
    {%- if show_link_button -%}
      <div class="sideproduct-btn">
        <a href="{{ section.settings.button_link }}" class="btn sidebarproduct">
          {{ section.settings.button_label | escape }}
        </a>
      </div>
    {%- endif -%}
  </ul>
</div>